<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UCC Wall</title>
     <link rel="icon" href="~/Content/Images/icon-wall.png" type="image/x-icon" />
    <!-- 1. Load libraries -->
    <!-- Polyfill(s) for older browsers -->
    <link href="~/Content/Site.css" rel="stylesheet" />
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
    <script src="~/libs/core-js/client/shim.min.js"></script>
    <script src="~/libs/zone.js/dist/zone.js"></script>
    <script src="~/libs/reflect-metadata/Reflect.js"></script>
    <script src="~/libs/systemjs/dist/system.src.js"></script>
    <base href="/" />

 
   
    <!-- 2. Configure SystemJS -->
   
    <script src="~/App/systemjs.config.js"></script>
    @*<script>
        System.import('../App/main').catch(function (err)
        {
            console.error(err);
        });
    </script>*@
    <script>
        System.config({ meta: { '../App/bundle.js': { format: 'global' } } })
        System.import('../App/bundle').catch(function (err) {
            console.error(err);
        });

       
    </script>



</head>
<body>
  
  
        @RenderBody()
       
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @RenderSection("scripts", required: false)

    <script src="~/Scripts/jquery.signalR-2.2.1.js"></script>
    <script src="~/signalR/hubs" type="text/javascript"></script>

    <script>
        // .modal-backdrop classes

        $(".modal-transparent").on('show.bs.modal', function () {
            setTimeout(function () {
                $(".modal-backdrop").addClass("modal-backdrop-transparent");
            }, 0);
        });
        $(".modal-transparent").on('hidden.bs.modal', function () {
            $(".modal-backdrop").addClass("modal-backdrop-transparent");
        });

        $(".modal-fullscreen").on('show.bs.modal', function () {
            setTimeout(function () {
                $(".modal-backdrop").addClass("modal-backdrop-fullscreen");
            }, 0);
        });
        $(".modal-fullscreen").on('hidden.bs.modal', function () {
            $(".modal-backdrop").addClass("modal-backdrop-fullscreen");
        });

      

    </script>
  
    <script>

    var commentHub = $.connection.comment;
    $.connection.hub.start();
    commentHub.client.broadcastComment = function(comment, postUserID) {
       
        
        console.log(comment);
        var newDate = new Date(comment.DateCreated).toLocaleString();
        var finalDate = $.timeago(newDate);
       
        
        var encodeName = $('<div/>').text(comment.UserName).html();
        var encodeMessage = $('<div/>').text(comment.Content).html();
        var encodeDate = $('<div/>').text(finalDate).html();

        var appendID = "." + comment.PostID.replace(/[^\w\s]/gi, '');
        var appendNotifID = "#notif-" + postUserID.replace(/[^\w\s]/gi, '');
        console.log(appendNotifID);
        $(appendNotifID).html(parseInt($(appendNotifID).html()) + 1);

        $(appendID).append(`
              <li style="margin-left:-10px; list-style:none;">
                                    <div class="row">
                                        <div class="col-md-12 panelTop">
                                            <a *ngIf="accountStatus == comment.UserName" title="Delete Comment" class="pull-right" style="z-index:10"><i style="color:#e0d2c3;" class="glyphicon glyphicon-remove icon-arrow-right pull-right"></i></a>
                                            <div class="col-md-12" style="margin-bottom:10px;">
                                                <h5 style="color:dimgray;"><b>` + encodeName +`</b> <span><small style="font-size:xx-small; color:darkgray;" class="glyphicon glyphicon-time"></small> `+ encodeDate+`</span></h5>
                                                <p class="btn-info" style="display:inline-block; min-width:60px; padding:10px; border-radius:5px;">`+encodeMessage +`</p>

                                            </div>

                                        </div>

                                    </div>

                                </li>


        `);

        ////$('#messagesQuee').append('<li><b>' + encodeName + ':</b>' + encodeMessage + '</li>');


        //for (var i in this.posts) {
        //    if (this.posts[i].ID == comment.PostID) {
        //            this.posts[i].Comments.push(comment);
        //        break;
        //    }

        //}

    };

  

    </script>
    <!--CK editor-->
    <script src="~/Content/library/ckeditor/ckeditor.js"></script>
    <script src="~/Scripts/timeago.js"></script>
</body>
</html>